<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìŠµ ì§ˆë¬¸ ì•„ë°”íƒ€ ë¶„ì„ê¸°</title>
    
    <!-- CSS Styles -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f4f8;
            min-height: 100vh;
            padding: 20px;
        }
        
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background-color: #4a5568;
            color: white;
            text-align: center;
            padding: 30px;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 18px;
        }
        
        .content {
            padding: 30px;
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #2d3748;
            font-size: 16px;
        }
        
        .question-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            font-family: Arial, sans-serif;
            min-height: 120px;
            resize: vertical;
        }
        
        .question-input:focus {
            outline: none;
            border-color: #4299e1;
        }
        
        .subject-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .subject-button {
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            background: #ffffff;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            font-family: Arial, sans-serif;
        }
        
        .subject-button:hover {
            border-color: #4299e1;
            background-color: #f7fafc;
        }
        
        .subject-button.active {
            background-color: #4299e1;
            color: white;
            border-color: #4299e1;
        }
        
        .analyze-button {
            width: 100%;
            padding: 15px;
            background-color: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            font-family: Arial, sans-serif;
        }
        
        .analyze-button:hover {
            background-color: #38a169;
        }
        
        .analyze-button:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
        }
        
        .result-section {
            margin-top: 30px;
            display: none;
        }
        
        .character-card {
            background-color: #fef5e7;
            border: 2px solid #f6e05e;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
        }
        
        .character-avatar {
            font-size: 60px;
            margin-bottom: 15px;
            line-height: 1;
            position: relative;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* ì‚¼ê°í˜• ê¸°í•˜í•™ì  ì•„ë°”íƒ€ ìŠ¤íƒ€ì¼ */
        .geometric-avatar {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto;
        }
        
        .triangle {
            position: absolute;
            width: 0;
            height: 0;
        }
        
        .triangle-up {
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 26px solid;
        }
        
        .triangle-down {
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 17px solid;
        }
        
        .diamond {
            width: 12px;
            height: 12px;
            background: currentColor;
            transform: rotate(45deg);
        }
        
        .character-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .character-description {
            font-size: 16px;
            color: #4a5568;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .tone-analysis {
            background-color: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .tone-label {
            font-weight: bold;
            color: #2d3748;
        }
        
        .subject-info {
            background-color: #ebf8ff;
            border: 1px solid #90cdf4;
            border-radius: 8px;
            padding: 15px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
            display: none;
        }
        
        .spinner {
            border: 4px solid #f1f5f9;
            border-top: 4px solid #4299e1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .header p {
                font-size: 16px;
            }
            
            .subject-buttons {
                flex-direction: column;
            }
            
            .subject-button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <h1>ğŸ­ í•™ìŠµ ì§ˆë¬¸ ë¶„ì„ê¸°</h1>
            <p>ì§ˆë¬¸ì˜ ë§íˆ¬ë¥¼ ë¶„ì„í•´ì„œ ë§ì¶¤ ì•„ë°”íƒ€ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!</p>
        </div>
        
        <div class="content">
            <div class="input-section">
                <div class="form-group">
                    <label>ğŸ“ í•™ìŠµ ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”:</label>
                    <textarea
                        id="question-input"
                        class="question-input"
                        placeholder="ì˜ˆ: ìˆ˜í•™ ë¬¸ì œê°€ ë„ˆë¬´ ì–´ë ¤ì›Œìš”. ë„ì™€ì£¼ì„¸ìš”!"
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label>ğŸ“š ê³¼ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”:</label>
                    <div class="subject-buttons">
                        <button class="subject-button" data-subject="êµ­ì–´">êµ­ì–´</button>
                        <button class="subject-button" data-subject="ì˜ì–´">ì˜ì–´</button>
                        <button class="subject-button" data-subject="ìˆ˜í•™">ìˆ˜í•™</button>
                        <button class="subject-button" data-subject="ì‚¬íšŒ">ì‚¬íšŒ</button>
                        <button class="subject-button" data-subject="ê³¼í•™">ê³¼í•™</button>
                    </div>
                </div>
                
                <button id="analyze-button" class="analyze-button">
                    ğŸ” ë¶„ì„í•˜ê¸°
                </button>
            </div>
            
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>ì§ˆë¬¸ì„ ë¶„ì„í•˜ê³  ìˆì–´ìš”...</p>
            </div>
            
            <div id="result-section" class="result-section">
                <div class="character-card">
                    <div id="character-avatar" class="character-avatar"></div>
                    <div id="character-name" class="character-name"></div>
                    <div id="character-description" class="character-description"></div>
                    <div class="tone-analysis">
                        <span class="tone-label">ê°ì§€ëœ ê°ì •:</span> <span id="tone-result"></span>
                    </div>
                    <div class="subject-info">
                        <span class="tone-label">ì„ íƒí•œ ê³¼ëª©:</span> <span id="subject-result"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 5ê³¼ëª© Ã— 4ì¸ë¬¼ ìºë¦­í„° ë°ì´í„°ë² ì´ìŠ¤
        const characterDatabase = {
            êµ­ì–´: {
                ë…¼ë¦¬ì : { avatar: "ğŸ‘‘", name: "ì„¸ì¢…ëŒ€ì™•", description: "í•œê¸€ì„ ì°½ì œí•œ ì„±êµ°ì´ë¡œë‹¤. ë°±ì„±ì´ ì‰½ê²Œ ë°°ìš¸ ìˆ˜ ìˆëŠ” ê¸€ìë¥¼ ë§Œë“¤ì—ˆë…¸ë¼." },
                ê·€ì—¬ì›€: { avatar: "ğŸ¨", name: "ì‹ ì‚¬ì„ë‹¹", description: "ê·¸ë¦¼ê³¼ ê¸€ì”¨ë¥¼ ì‚¬ë‘í•˜ëŠ” ì–´ë¨¸ë‹ˆì˜ˆìš”~ í•¨ê»˜ ì•„ë¦„ë‹¤ìš´ ì‘í’ˆì„ ë§Œë“¤ì–´ë´ìš”!" },
                í˜¸ê¸°ì‹¬: { avatar: "ğŸŒ™", name: "ê¹€ì†Œì›”", description: "ì§„ë‹¬ë˜ê½ƒì´ íë“œëŸ¬ì§„ ì‚°ì—ì„œ ë¬´ìŠ¨ ì´ì•¼ê¸°ê°€ ìˆ¨ì–´ìˆì„ê¹Œìš”? ì‹œì˜ ì„¸ê³„ë¡œ ë– ë‚˜ë´ìš”!" },
                ì§œì¦: { avatar: "âœï¸", name: "ìœ¤ë™ì£¼", description: "ë³„ í—¤ëŠ” ë°¤... ê´´ë¡œìš´ ì‹œëŒ€ì— ì‹œë¥¼ ì“°ëŠ” ê²ƒë„ ì‰½ì§€ ì•Šêµ¬ë‚˜. ë‹µë‹µí•´." }
            },
            ì˜ì–´: {
                ë…¼ë¦¬ì : { avatar: "ğŸ­", name: "ì…°ìµìŠ¤í”¼ì–´", description: "To be or not to be. ì¸ê°„ ì¡´ì¬ì˜ ë³¸ì§ˆì„ íƒêµ¬í•˜ëŠ” ê²ƒì´ ë¬¸í•™ì˜ ì—­í• ì´ì§€." },
                ê·€ì—¬ì›€: { avatar: "ğŸ“º", name: "ì—˜ë Œ ì‡¼", description: "Be kind to one another! ëª¨ë“  ì‚¬ëŒì—ê²Œ ì¹œì ˆí•˜ê²Œ ëŒ€í•´ìš”~ í•¨ê»˜ ì›ƒì–´ë´ìš”!" },
                í˜¸ê¸°ì‹¬: { avatar: "ğŸª„", name: "JK ë¡¤ë§", description: "ë§ˆë²•ì˜ ì„¸ê³„ì—ëŠ” ì–´ë–¤ ë¹„ë°€ì´ ìˆ¨ì–´ìˆì„ê¹Œìš”? ìƒìƒë ¥ì´ í˜„ì‹¤ì„ ë§Œë“¤ì–´ë‚´ì£ !" },
                ì§œì¦: { avatar: "ğŸ‡ºğŸ‡¸", name: "ë²„ë½ ì˜¤ë°”ë§ˆ", description: "Yes, we can! ...ì´ë¼ê³  í–ˆì§€ë§Œ í˜„ì‹¤ì€ ê·¸ë ‡ê²Œ ì‰½ì§€ ì•Šë”êµ°ìš”. ì •ì¹˜ëŠ” ë³µì¡í•´." }
            },
            ìˆ˜í•™: {
                ë…¼ë¦¬ì : { avatar: "ğŸ“", name: "í”¼íƒ€ê³ ë¼ìŠ¤", description: "ì§ê°ì‚¼ê°í˜•ì˜ ì„¸ ë³€ì—ëŠ” ì˜ì›í•œ ì§„ë¦¬ê°€ ìˆ¨ì–´ìˆë‹¤. aÂ²+bÂ²=cÂ²" },
                í˜¸ê¸°ì‹¬: { avatar: "âˆ", name: "ì˜¤ì¼ëŸ¬", description: "e^(iÏ€)+1=0... ì´ ì•„ë¦„ë‹¤ìš´ ê³µì‹ì—ëŠ” ë¬´í•œí•œ ë¹„ë°€ì´ ë‹´ê²¨ìˆì–´ìš”!" },
                ê·€ì—¬ì›€: { avatar: "âˆ«", name: "ë¼ì´í”„ë‹ˆì¸ ", description: "ë¯¸ì ë¶„ì€ ë³€í™”í•˜ëŠ” ì„¸ìƒì„ ì´í•´í•˜ëŠ” ì—´ì‡ ì˜ˆìš”~ í•¨ê»˜ ê³„ì‚°í•´ë´ìš”!" },
                ì§œì¦: { avatar: "ğŸ›", name: "ì•„ë¥´í‚¤ë©”ë°ìŠ¤", description: "ìœ ë ˆì¹´! ...ë¼ê³  ì™¸ì³¤ì§€ë§Œ ì§€ê¸ˆì€ ë¬¼ë¦¬ ë²•ì¹™ ì„¤ëª…í•˜ê¸° ê·€ì°®ì•„. ì™œ ëª¨ë¥´ëŠ” ê±°ì•¼?" }
            },
            ì‚¬íšŒ: {
                ë…¼ë¦¬ì : { avatar: "ğŸ“š", name: "ê³µì", description: "í•™ì´ì‹œìŠµì§€ ë¶ˆì—­ì—´í˜¸. ë°°ìš°ê³  ë•Œë¡œ ìµíˆë©´ ê¸°ì˜ì§€ ì•„ë‹ˆí•œê°€." },
                í˜¸ê¸°ì‹¬: { avatar: "ğŸ’­", name: "ì†Œí¬ë¼í…ŒìŠ¤", description: "ë„ˆ ìì‹ ì„ ì•Œë¼. ë¬´ì—‡ì´ ì§„ì •í•œ ì§€í˜œì¼ê¹Œìš”? í•¨ê»˜ ëŒ€í™”í•´ë´…ì‹œë‹¤!" },
                ê·€ì—¬ì›€: { avatar: "ğŸ—ºï¸", name: "ë§ˆë¥´ì½” í´ë¡œ", description: "ë™ë°©ê²¬ë¬¸ë¡ì— ë‹´ê¸´ ì‹ ê¸°í•œ ì´ì•¼ê¸°ë“¤ì„ ë“¤ë ¤ë“œë¦´ê²Œìš”~ ëª¨í—˜ì„ ë– ë‚˜ë´ìš”!" },
                ì§œì¦: { avatar: "ğŸ‘‘", name: "ì •ì¡°", description: "ê°œí˜ì„ ì¶”ì§„í•˜ë ¤ í•˜ë‚˜ ì‹ í•˜ë“¤ì´ ë§ì„ ë“£ì§€ ì•ŠëŠ”êµ¬ë‚˜. ì •ë§ ë‹µë‹µí•˜ë‹¤!" }
            },
            ê³¼í•™: {
                ë…¼ë¦¬ì : { avatar: "ğŸ§ ", name: "ì•„ì¸ìŠˆíƒ€ì¸", description: "ìƒëŒ€ì„±ì´ë¡ ìœ¼ë¡œ ìš°ì£¼ì˜ ë¹„ë°€ì„ ë°í˜€ëƒˆìŠµë‹ˆë‹¤. E=mcÂ²" },
                ì§œì¦: { avatar: "ğŸ", name: "ë‰´í„´", description: "ë§Œìœ ì¸ë ¥ì˜ ë²•ì¹™! ì‚¬ê³¼ê°€ ë–¨ì–´ì§€ëŠ” ê²ƒë„ ëª¨ë¥´ë‹¤ë‹ˆ... ì •ë§ ë‹µë‹µí•´!" },
                í˜¸ê¸°ì‹¬: { avatar: "ğŸ’¡", name: "ì—ë””ìŠ¨", description: "1%ì˜ ì˜ê°ê³¼ 99%ì˜ ë…¸ë ¥! ìƒˆë¡œìš´ ë°œëª…í’ˆì„ ë§Œë“¤ì–´ë³¼ê¹Œìš”?" },
                ê·€ì—¬ì›€: { avatar: "ğŸ¤–", name: "ë„ë¼ì—ëª½", description: "ë¯¸ë˜ì—ì„œ ì˜¨ ê³ ì–‘ì´ ë¡œë´‡ì´ì•¼! ì£¼ë¨¸ë‹ˆì—ì„œ ì‹ ê¸°í•œ ë„êµ¬ë¥¼ êº¼ë‚´ì¤„ê²Œ~" }
            }
        };

        // 16ê°€ì§€ ê°ì • ë¶„ì„ í•¨ìˆ˜
        function analyzeTone(question) {
            // ê° ê°ì •ë³„ í‚¤ì›Œë“œ ì •ì˜
            const emotionKeywords = {
                ê·€ì—¬ì›€: ['ë„ì™€ì£¼ì„¸ìš”', 'ì•Œë ¤ì£¼ì„¸ìš”', 'ê¶ê¸ˆí•´ìš”', 'ëª¨ë¥´ê² ì–´ìš”', 'ë¶€íƒë“œë ¤ìš”', 'ê°ì‚¬í•´ìš”', 'ê³ ë§ˆì›Œìš”', 'í•¨ê»˜', 'ê°™ì´', 'ì²œì²œíˆ', 'ì˜ˆì˜ê²Œ', 'ì‚¬ë‘ìŠ¤ëŸ½ê²Œ', 'ê·€ì—½ê²Œ'],
                ì§œì¦: ['ëª°ë¼', 'ëª¨ë¦„', 'ë¹¨ë¦¬', 'ë‹µë§Œ', 'ëŒ€ì¶©', 'ê·€ì°®', 'ì§œì¦', 'í•˜ê¸°ì‹«', 'ì™œ ì´ë ‡ê²Œ', 'ì§„ì§œ', 'í™”ë‚˜', 'ë‹µë‹µ', 'ë¹¡ì³', 'ì—´ë°›', 'ì–´ì´ì—†'],
                ì²´ë…: ['ì–´ì°¨í”¼', 'í¬ê¸°', 'ì•ˆë˜ê² ', 'í˜ë“¤ë‹¤', 'ë¬´ë¦¬', 'ë¶ˆê°€ëŠ¥', 'ì•„ë¬´ë˜ë„', 'ê·¸ë§Œ', 'í¬ê¸°í• ë˜', 'ì•ˆë ê±°ì•¼', 'ì–´ì©”ìˆ˜ì—†', 'ì²´ë…', 'ëì–´'],
                ìŠ¬í””: ['ìŠ¬í¼', 'ìš°ìš¸', 'ëˆˆë¬¼', 'ìš¸ì–´', 'ì„œëŸ¬ì›Œ', 'í˜ë“¤ì–´', 'ê´´ë¡œì›Œ', 'ì•„íŒŒ', 'ë§ˆìŒì´', 'ê°€ìŠ´ì´', 'ì•ˆíƒ€ê¹Œì›Œ', 'ì“¸ì“¸', 'ì™¸ë¡œì›Œ'],
                ë‚™ì²œì : ['ì¢‹ì•„', 'ì¦ê±°ì›Œ', 'ì‹ ë‚˜', 'ìµœê³ ', 'í›Œë¥­', 'ë©‹ì ¸', 'ì¬ë°Œì–´', 'ê¸°ëŒ€ë¼', 'í–‰ë³µ', 'ë°ê²Œ', 'ê¸ì •ì ', 'í¬ë§', 'íŒŒì´íŒ…'],
                ë…¼ë¦¬ì : ['ì™œëƒí•˜ë©´', 'ë”°ë¼ì„œ', 'ê·¸ëŸ¬ë¯€ë¡œ', 'ê·¼ê±°', 'ì¦ëª…', 'ë…¼ë¦¬', 'ì´ìœ ', 'ì›ì¸', 'ê²°ê³¼', 'ì²´ê³„ì ', 'ë‹¨ê³„ë³„', 'ìˆœì„œëŒ€ë¡œ', 'ë…¼ì¦'],
                ë¶„ì„ì : ['ë¶„ì„', 'í•´ë¶€', 'ìì„¸íˆ', 'ì„¸ë¶€ì ', 'êµ¬ì²´ì ', 'ì •ë°€', 'ë©´ë°€', 'ê¼¼ê¼¼', 'ì²´ê³„', 'ë¶„í•´', 'ìš”ì†Œë³„', 'ë‹¨ê³„ë³„'],
                ì§„ì§€í•¨: ['ì‹¬ê°', 'ì¤‘ìš”', 'ì‹ ì¤‘', 'ì§„ì§€', 'ì—„ì¤‘', 'ì—„ê²©', 'ì§„ì†”', 'ì •ì¤‘', 'ê²©ì‹', 'ê³µì‹ì ', 'ì˜ë¯¸ìˆëŠ”'],
                ë†ë‹´: ['í•˜í•˜', 'ã…‹ã…‹', 'ì›ƒê²¨', 'ì¬ë°Œë„¤', 'ë†ë‹´', 'ì¥ë‚œ', 'ìœ ë¨¸', 'ê°œê·¸', 'ì½”ë¯¹', 'ì›ƒìŒ', 'ìš°ìŠ¤ì›Œ', 'í‚¥í‚¥'],
                ë¬´ê¸°ë ¥: ['í”¼ê³¤', 'ì§€ì³', 'í˜ì—†ì–´', 'ë‚˜ë¥¸', 'ê·€ì°®ì•„', 'ì˜ìš•ì—†ì–´', 'ë¬´ê¸°ë ¥', 'í„¸í„¸', 'ì¶• ëŠ˜ì–´ì ¸', 'ë§¥ë¹ ì ¸'],
                í˜¸ê¸°ì‹¬: ['ê¶ê¸ˆ', 'ì‹ ê¸°', 'í¥ë¯¸', 'ê´€ì‹¬', 'ì•Œê³ ì‹¶ì–´', 'íƒêµ¬', 'ì—°êµ¬', 'ì¡°ì‚¬', 'íŒŒì•…', 'ì´í•´í•˜ê³ ì‹¶', 'ë°°ìš°ê³ ì‹¶'],
                ë‹¹í™©: ['ì–´?', 'ë­?', 'í—‰', 'ì–´ë–»ê²Œ', 'ë§ë„ì•ˆë¼', 'ì´ìƒí•´', 'ê°‘ìê¸°', 'ì˜ˆìƒëª»í•œ', 'ë†€ë¼ì›Œ', 'ì–´ë¦¬ë‘¥ì ˆ', 'í™©ë‹¹'],
                ìŠ¹ë¶€ìš•: ['ì´ê²¨ì•¼', 'ë°˜ë“œì‹œ', 'ê¼­', 'ì ˆëŒ€', 'ë¬´ì¡°ê±´', 'ëê¹Œì§€', 'í¬ê¸°ì•ˆí•´', 'ë„ì „', 'ìŠ¹ë¦¬', 'ì„±ê³µ', 'í•´ë‚´ê² ì–´'],
                ì§‘ì°©: ['ê³„ì†', 'ëŠì„ì—†ì´', 'ë°˜ë³µ', 'ë˜ ë‹¤ì‹œ', 'ê³„ì†í•´ì„œ', 'ë©ˆì¶œìˆ˜ì—†ì–´', 'ë” ë”', 'ëì—†ì´', 'ì™„ë²½í•˜ê²Œ'],
                ë¹„íŒì : ['ë¬¸ì œê°€', 'ì˜ëª»ëœ', 'í‹€ë ¸ì–´', 'ì´ìƒí•´', 'ì˜ì‹¬ìŠ¤ëŸ¬ì›Œ', 'ë¹„íŒ', 'ì§€ì ', 'ê°œì„ ', 'ìˆ˜ì •', 'ë°”ê¿”ì•¼'],
                ê°ì„±ì : ['ëŠë‚Œ', 'ê°ë™', 'ë§ˆìŒ', 'ê°ì •', 'ëŠê»´ì ¸', 'ì™€ë‹¿ì•„', 'ê³µê°', 'ì´í•´ë¼', 'ì•„ë¦„ë‹¤ì›Œ', 'ì†Œì¤‘í•´']
            };

            // ë¬¸ì¥ íŒ¨í„´ ë¶„ì„
            const patterns = {
                ê·€ì—¬ì›€: [/í•´ìš”\?*$/, /ìš”\?*$/, /ì„¸ìš”\?*$/, /ë“œë ¤ìš”\?*$/, /ìŠµë‹ˆë‹¤\?*$/],
                ì§œì¦: [/ì•¼\?*$/, /ëƒ\?*$/, /ê±°ì•¼\?*$/, /ë‹¤ê³ \?*$/],
                ë…¼ë¦¬ì : [/ë•Œë¬¸ì—/, /ì´ë¯€ë¡œ/, /ê·¸ë˜ì„œ/, /ì¦ëª…/],
                í˜¸ê¸°ì‹¬: [/(ì™œ|ë¬´ì—‡|ì–´ë–»ê²Œ|ì–¸ì œ|ì–´ë””).*\?/, /ê¶ê¸ˆ.*\?/, /ì•Œê³ .*ì‹¶.*\?/, /ì‹ ê¸°.*\?/, /í¥ë¯¸.*\?/],
                ë‹¹í™©: [/!+/, /ì–´\?/, /ë­\?/, /í—‰/, /ì–´ë–»ê²Œ.*ì´ëŸ´/],
                ê°ì„±ì : [/\.\.\./, /~/, /â™¡/, /â¤/, /ëŠê»´ì ¸/, /ì™€ë‹¿/],
                ë†ë‹´: [/ã…‹ã…‹/, /í•˜í•˜/, /ì›ƒê²¨/, /ì¬ë°Œ/],
                ìŠ¹ë¶€ìš•: [/ë°˜ë“œì‹œ/, /ê¼­/, /ì ˆëŒ€/, /ë¬´ì¡°ê±´/],
                ìŠ¬í””: [/í‘í‘/, /ã… ã… /, /ìš¸ì–´/, /ìŠ¬í¼/]
            };

            // ê° ê°ì •ë³„ ì ìˆ˜ ê³„ì‚°
            const scores = {};
            
            // í‚¤ì›Œë“œ ê¸°ë°˜ ì ìˆ˜ ê³„ì‚°
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                scores[emotion] = keywords.filter(keyword => question.includes(keyword)).length;
            }
            
            // íŒ¨í„´ ê¸°ë°˜ ì¶”ê°€ ì ìˆ˜
            for (const [emotion, patternList] of Object.entries(patterns)) {
                const patternScore = patternList.filter(pattern => pattern.test(question)).length;
                scores[emotion] = (scores[emotion] || 0) + patternScore;
            }

            // ê°€ì¥ ë†’ì€ ì ìˆ˜ì˜ ê°ì •ë“¤ ì°¾ê¸°
            const maxScore = Math.max(...Object.values(scores));
            
            if (maxScore === 0) {
                // í‚¤ì›Œë“œë‚˜ íŒ¨í„´ì´ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ ê·œì¹™ ì ìš©
                if (question.length > 50) return 'ë¶„ì„ì ';
                if (question.length < 10) return 'ë‹¹í™©';
                if (question.includes('?') && (question.includes('ì™œ') || question.includes('ë¬´ì—‡') || question.includes('ì–´ë–»ê²Œ'))) {
                    return 'í˜¸ê¸°ì‹¬';
                }
                if (question.includes('?')) {
                    // ë‹¨ìˆœí•œ ë¬¼ìŒí‘œëŠ” ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì²˜ë¦¬
                    if (question.includes('í•´ìš”') || question.includes('ìš”')) return 'ê·€ì—¬ì›€';
                    if (question.includes('ì•¼') || question.includes('ê±°ì•¼')) return 'ì§œì¦';
                    return 'ë‹¹í™©'; // ê¸°ë³¸ ë¬¼ìŒí‘œëŠ” ë‹¹í™©ìœ¼ë¡œ
                }
                return 'ë…¼ë¦¬ì '; // ê¸°ë³¸ê°’
            }
            
            // ìµœê³  ì ìˆ˜ë¥¼ ë°›ì€ ê°ì •ë“¤ ì¤‘ì—ì„œ ì„ íƒ
            const topEmotions = Object.entries(scores)
                .filter(([emotion, score]) => score === maxScore)
                .map(([emotion, score]) => emotion);
            
            // ì—¬ëŸ¬ ê°ì •ì´ ê°™ì€ ì ìˆ˜ë©´ ì²« ë²ˆì§¸ ê²ƒ ì„ íƒ
            return topEmotions[0];
        }

        // 16ê°€ì§€ ê°ì •ì„ 4ê°€ì§€ ì£¼ìš” ê°ì •ìœ¼ë¡œ ë§¤í•‘
        function mapToMainEmotion(detectedEmotion) {
            const emotionMapping = {
                // ë…¼ë¦¬ì  ê·¸ë£¹
                ë…¼ë¦¬ì : 'ë…¼ë¦¬ì ',
                ë¶„ì„ì : 'ë…¼ë¦¬ì ', 
                ì§„ì§€í•¨: 'ë…¼ë¦¬ì ',
                
                // ê·€ì—¬ì›€ ê·¸ë£¹  
                ê·€ì—¬ì›€: 'ê·€ì—¬ì›€',
                ë‚™ì²œì : 'ê·€ì—¬ì›€',
                ê°ì„±ì : 'ê·€ì—¬ì›€',
                
                // í˜¸ê¸°ì‹¬ ê·¸ë£¹
                í˜¸ê¸°ì‹¬: 'í˜¸ê¸°ì‹¬',
                ìŠ¹ë¶€ìš•: 'í˜¸ê¸°ì‹¬', 
                ë†ë‹´: 'í˜¸ê¸°ì‹¬',
                
                // ì§œì¦ ê·¸ë£¹
                ì§œì¦: 'ì§œì¦',
                ì²´ë…: 'ì§œì¦',
                ìŠ¬í””: 'ì§œì¦',
                ë¬´ê¸°ë ¥: 'ì§œì¦',
                ë‹¹í™©: 'ì§œì¦',
                ì§‘ì°©: 'ì§œì¦',
                ë¹„íŒì : 'ì§œì¦'
            };
            
            return emotionMapping[detectedEmotion] || 'ë…¼ë¦¬ì ';
        }

        // 4ê°€ì§€ ì£¼ìš” ê°ì •ë³„ ì„¤ëª… í•¨ìˆ˜
        function getEmotionDescription(emotion) {
            const descriptions = {
                ë…¼ë¦¬ì : "ì°¨ë¶„í•˜ê³  ì´ì„±ì ì¸",
                ê·€ì—¬ì›€: "ì‚¬ë‘ìŠ¤ëŸ½ê³  ì• êµê°€ ë§ì€", 
                í˜¸ê¸°ì‹¬: "ê¶ê¸ˆí•˜ê³  íƒêµ¬ì ì¸",
                ì§œì¦: "í™”ê°€ ë‚˜ê³  ë‹µë‹µí•œ"
            };
            return descriptions[emotion] || "íŠ¹ë³„í•œ";
        }

        // ì•„ë°”íƒ€ ìƒì„± í•¨ìˆ˜ (ì´ë¯¸ì§€ ë˜ëŠ” ê¸°í•˜í•™ì )
        function createAvatar(emotion, subject, characterName) {
            // ì•„ì¸ìŠˆíƒ€ì¸ ìºë¦­í„°ë©´ ì‹¤ì œ ì´ë¯¸ì§€ ì‚¬ìš©
            if (characterName.includes('ì•„ì¸ìŠˆíƒ€ì¸')) {
                return `<img src="ì•„ì¸ìŠˆíƒ€ì¸.png" alt="ì•„ì¸ìŠˆíƒ€ì¸" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #666; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">`;
            }
            
            // ì¼ë°˜ ìºë¦­í„°ëŠ” ê¸°í•˜í•™ì  ì•„ë°”íƒ€ ì‚¬ìš©
            return createGeometricAvatar(emotion, subject);
        }

        // ì‚¼ê°í˜• ê¸°í•˜í•™ì  ì•„ë°”íƒ€ ìƒì„± í•¨ìˆ˜
        function createGeometricAvatar(emotion, subject) {
            const colors = {
                ê·€ì—¬ì›€: '#ff9999', ì§œì¦: '#ff4444', ì²´ë…: '#999999',
                ìŠ¬í””: '#6699ff', ë‚™ì²œì : '#ffcc33', ë…¼ë¦¬ì : '#66cc99',
                ë¶„ì„ì : '#9966cc', ì§„ì§€í•¨: '#666666', ë†ë‹´: '#ff6600',
                ë¬´ê¸°ë ¥: '#cccccc', í˜¸ê¸°ì‹¬: '#33ccff', ë‹¹í™©: '#ff3366',
                ìŠ¹ë¶€ìš•: '#ff0000', ì§‘ì°©: '#990099', ë¹„íŒì : '#cc6600',
                ê°ì„±ì : '#ff99cc'
            };
            
            const color = colors[emotion] || '#666666';
            
            let avatarHTML = `<div class="geometric-avatar">`;
            
            // ê°ì •ë³„ ì‚¼ê°í˜• íŒ¨í„´
            switch(emotion) {
                case 'ê·€ì—¬ì›€':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 10px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 20px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 50px;"></div>
                        <div class="triangle triangle-down" style="border-top-color: ${color}; top: 60px; left: 35px; transform: scale(0.8);"></div>
                    `;
                    break;
                case 'ì§œì¦':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 5px; left: 15px; transform: rotate(-20deg);"></div>
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 5px; left: 45px; transform: rotate(20deg);"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 20px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 50px;"></div>
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 65px; left: 30px; transform: rotate(180deg) scale(0.6);"></div>
                    `;
                    break;
                case 'í˜¸ê¸°ì‹¬':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 8px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 40px; left: 15px; transform: rotate(45deg) scale(1.2);"></div>
                        <div class="diamond" style="background: ${color}; top: 40px; left: 50px; transform: rotate(45deg) scale(1.2);"></div>
                        <div class="triangle triangle-down" style="border-top-color: ${color}; top: 60px; left: 35px;"></div>
                        <div style="position: absolute; top: 65px; left: 40px; color: ${color}; font-size: 12px;">?</div>
                    `;
                    break;
                case 'ë‹¹í™©':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 15px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 18px; transform: rotate(45deg) scale(0.8);"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 48px; transform: rotate(45deg) scale(1.2);"></div>
                        <div style="position: absolute; top: 60px; left: 35px; color: ${color}; font-size: 16px;">!</div>
                    `;
                    break;
                case 'ìŠ¬í””':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 12px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 48px; left: 20px; transform: rotate(45deg);"></div>
                        <div class="diamond" style="background: ${color}; top: 48px; left: 50px; transform: rotate(45deg);"></div>
                        <div class="triangle triangle-down" style="border-top-color: ${color}; top: 65px; left: 35px; transform: rotate(180deg);"></div>
                        <div style="position: absolute; top: 68px; left: 25px; color: ${color}; font-size: 8px;">ğŸ’§</div>
                    `;
                    break;
                case 'ë‚™ì²œì ':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 8px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 42px; left: 20px; transform: rotate(45deg) scale(1.1);"></div>
                        <div class="diamond" style="background: ${color}; top: 42px; left: 50px; transform: rotate(45deg) scale(1.1);"></div>
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 58px; left: 32px; transform: rotate(180deg) scale(0.7);"></div>
                        <div style="position: absolute; top: 5px; left: 35px; color: ${color}; font-size: 10px;">âœ¨</div>
                    `;
                    break;
                case 'ìŠ¹ë¶€ìš•':
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 5px; left: 25px; transform: scale(1.2);"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 15px; transform: rotate(45deg) scale(0.9);"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 55px; transform: rotate(45deg) scale(0.9);"></div>
                        <div class="triangle triangle-down" style="border-top-color: ${color}; top: 60px; left: 35px; transform: scale(0.8);"></div>
                        <div style="position: absolute; top: 25px; left: 5px; color: ${color}; font-size: 10px;">ğŸ”¥</div>
                        <div style="position: absolute; top: 25px; left: 65px; color: ${color}; font-size: 10px;">ğŸ”¥</div>
                    `;
                    break;
                default:
                    avatarHTML += `
                        <div class="triangle triangle-up" style="border-bottom-color: ${color}; top: 10px; left: 25px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 20px;"></div>
                        <div class="diamond" style="background: ${color}; top: 45px; left: 50px;"></div>
                        <div class="triangle triangle-down" style="border-top-color: ${color}; top: 60px; left: 35px;"></div>
                    `;
            }
            
            avatarHTML += `</div>`;
            return avatarHTML;
        }

        // ì „ì—­ ë³€ìˆ˜
        let selectedSubject = '';

        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const questionInput = document.getElementById('question-input');
        const analyzeButton = document.getElementById('analyze-button');
        const loading = document.getElementById('loading');
        const resultSection = document.getElementById('result-section');
        const subjectButtons = document.querySelectorAll('.subject-button');

        // ê³¼ëª© ì„ íƒ ì´ë²¤íŠ¸
        subjectButtons.forEach(button => {
            button.addEventListener('click', function() {
                // ëª¨ë“  ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                subjectButtons.forEach(btn => btn.classList.remove('active'));
                // í´ë¦­ëœ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
                this.classList.add('active');
                selectedSubject = this.getAttribute('data-subject');
            });
        });

        // ë¶„ì„ ë²„íŠ¼ ì´ë²¤íŠ¸
        analyzeButton.addEventListener('click', function() {
            const question = questionInput.value.trim();
            
            if (!question || !selectedSubject) {
                alert('ì§ˆë¬¸ê³¼ ê³¼ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // ë²„íŠ¼ ë¹„í™œì„±í™”
            analyzeButton.disabled = true;
            analyzeButton.textContent = 'ë¶„ì„ ì¤‘...';
            
            // ë¡œë”© í‘œì‹œ
            loading.style.display = 'block';
            resultSection.style.display = 'none';

            // ë¶„ì„ ì‹œë®¬ë ˆì´ì…˜ (1.5ì´ˆ ëŒ€ê¸°)
            setTimeout(() => {
                const detectedEmotion = analyzeTone(question);
                const mainEmotion = mapToMainEmotion(detectedEmotion);
                const character = characterDatabase[selectedSubject][mainEmotion];
                
                // ê²°ê³¼ í‘œì‹œ
                document.getElementById('character-avatar').innerHTML = createAvatar(mainEmotion, selectedSubject, character.name);
                document.getElementById('character-name').textContent = character.name;
                document.getElementById('character-description').textContent = character.description;
                document.getElementById('tone-result').textContent = `${detectedEmotion} â†’ ${mainEmotion} (${getEmotionDescription(mainEmotion)})`;
                document.getElementById('subject-result').textContent = selectedSubject;
                
                // UI ì—…ë°ì´íŠ¸
                loading.style.display = 'none';
                resultSection.style.display = 'block';
                
                // ë²„íŠ¼ í™œì„±í™”
                analyzeButton.disabled = false;
                analyzeButton.textContent = 'ğŸ” ë¶„ì„í•˜ê¸°';
            }, 1500);
        });
    </script>
</body>
</html>